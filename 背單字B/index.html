<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>ä¸­è‹±é…å°éŠæˆ²ï¼ˆç¬¬äºŒé—œï¼‰</title>
  <style>
    body {
      font-family: "Segoe UI", system-ui, -apple-system, BlinkMacSystemFont,
        "Noto Sans TC", sans-serif;
      background: #f4f6fb;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h1 {
      margin-bottom: 10px;
      font-size: 24px;
      color: #333;
      text-align: center;
    }

    .subtitle {
      font-size: 14px;
      color: #666;
      margin-bottom: 16px;
      text-align: center;
    }

    #message {
      min-height: 20px;
      margin-bottom: 12px;
      font-size: 14px;
      color: #444;
    }

    .grid {
      display: grid;
      grid-template-columns: repeat(5, minmax(100px, 1fr));
      gap: 10px;
      max-width: 620px;
      width: 100%;
    }

    .card {
      position: relative;
      border-radius: 10px;
      padding: 10px;
      min-height: 70px;
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-size: 16px;
      cursor: pointer;
      user-select: none;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.08);
      transition: transform 0.15s ease, box-shadow 0.15s ease,
        background-color 0.15s ease, color 0.15s ease;
      word-break: break-word;
    }

    .card.chinese {
      background: #fff7da;
      color: #333;
    }

    .card.english {
      background: #cfd5ff;
      color: #333;
    }

    /* è‹±æ–‡å¡ä¸€é–‹å§‹åªé¡¯ç¤ºã€Œï¼Ÿã€ */
    .card.english.hidden-text {
      color: #333;
      font-size: 22px;
      font-weight: bold;
    }

    .card:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.12);
    }

    .card.selected {
      outline: 3px solid #ff9800;
      box-shadow: 0 0 0 3px rgba(255, 152, 0, 0.4);
    }

    .card.matched {
      background: #c8e6c9 !important;
      color: #1b5e20 !important;
      cursor: default;
      box-shadow: none;
      transform: none;
    }

    .card.matched:hover {
      box-shadow: none;
      transform: none;
    }

    .footer {
      margin-top: 16px;
      font-size: 12px;
      color: #888;
      text-align: center;
    }

    @media (max-width: 600px) {
      .grid {
        grid-template-columns: repeat(4, minmax(70px, 1fr));
      }

      .card {
        font-size: 14px;
        min-height: 60px;
      }
    }
  </style>
</head>
<body>
  <h1>ä¸­è‹±é…å°éŠæˆ²ï¼ˆç¬¬äºŒé—œï¼‰</h1>
  <div class="subtitle">
    é€™ä¸€é—œæ˜¯ã€Œè¡£æœï¼‹å®¶äººã€ï¼‹ light / prettyã€‚<br />
    ä¸€æ¨£ï¼šå…ˆé»ä¸­æ–‡ï¼Œå†é»è‹±æ–‡ã€‚ç¿»é–‹è‹±æ–‡æ™‚æœƒå”¸å‡ºå–®å­—ï¼Œé…å°æˆåŠŸæœ‰å®å’šéŸ³æ•ˆ âœ¨
  </div>

  <div id="message"></div>

  <div class="grid" id="grid"></div>

  <div class="footer">
    å»ºè­°è®“å­©å­å…ˆå¿µä¸­æ–‡ï¼Œå†å»æ‰¾è‹±æ–‡ï¼›ä¹Ÿå¯ä»¥è·Ÿç¬¬ä¸€é—œè¼ªæµç© ğŸ˜„
  </div>

  <script>
    // ç¬¬äºŒé—œï¼š10 çµ„å–®å­—ï¼ˆè‹±æ–‡ï¼‹ä¸­æ–‡ï¼‰
    const words = [
      { id: 1,  english: "light",   chinese: "è¼•çš„" },
      { id: 2,  english: "pretty",  chinese: "æ¼‚äº®çš„" },
      { id: 3,  english: "T-shirt", chinese: "T æ¤" },
      { id: 4,  english: "skirt",   chinese: "è£™å­" },
      { id: 5,  english: "dress",   chinese: "æ´‹è£" },
      { id: 6,  english: "jeans",   chinese: "ç‰›ä»”è¤²" },
      { id: 7,  english: "shoes",   chinese: "é‹å­" },
      { id: 8,  english: "uncle",   chinese: "å”å” / ä¼¯ä¼¯ / èˆ…èˆ…" },
      { id: 9,  english: "aunt",    chinese: "é˜¿å§¨ / å§‘å§‘ / èˆ…åª½ / ä¼¯æ¯" },
      { id: 10, english: "cousin",  chinese: "è¡¨ï¼ˆå ‚ï¼‰å…„å¼Ÿ / å§å¦¹" }
    ];

    // æ–¹ä¾¿ç”¨ id æ‰¾åŸæœ¬å–®å­—è³‡æ–™
    const wordMap = {};
    words.forEach((w) => (wordMap[w.id] = w));

    // æ´—ç‰Œå‡½å¼
    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
      return array;
    }

    const totalCards = 20;
    const totalPairs = words.length;
    const positions = new Array(totalCards);

    // 0~19 çš„ç´¢å¼•
    const indices = Array.from({ length: totalCards }, (_, i) => i);
    shuffle(indices);

    // å‰ 10 å€‹ä½ç½®ç•™çµ¦ä¸­æ–‡å¡ï¼Œå¾Œ 10 å€‹çµ¦è‹±æ–‡å¡ï¼ˆä½ç½®éš¨æ©Ÿï¼‰
    const chinesePositions = indices.slice(0, totalPairs);
    const englishPositions = indices.slice(totalPairs);

    // ä¸­æ–‡ã€è‹±æ–‡è³‡æ–™å„è‡ªæ‰“æ•£ï¼Œé¿å…å›ºå®šé †åº
    const chineseCardsData = shuffle(
      words.map((w) => ({ type: "chinese", id: w.id }))
    );
    const englishCardsData = shuffle(
      words.map((w) => ({ type: "english", id: w.id }))
    );

    chinesePositions.forEach((pos, i) => {
      positions[pos] = chineseCardsData[i];
    });

    englishPositions.forEach((pos, i) => {
      positions[pos] = englishCardsData[i];
    });

    const grid = document.getElementById("grid");
    const messageBox = document.getElementById("message");

    let selectedChinese = null; // { element, id }
    let lockBoard = false;      // é˜²æ­¢é€£é»

    function showMessage(text) {
      messageBox.textContent = text || "";
    }

    // âœ… æˆåŠŸé…å°å®å’šéŸ³æ•ˆ
    function playSuccessSound() {
      const AudioCtx = window.AudioContext || window.webkitAudioContext;
      if (!AudioCtx) return; // ä¸æ”¯æ´å°±ç•¥é

      if (!playSuccessSound.ctx) {
        playSuccessSound.ctx = new AudioCtx();
      }
      const ctx = playSuccessSound.ctx;
      const now = ctx.currentTime;

      // ç¬¬ä¸€è²
      const osc1 = ctx.createOscillator();
      const gain1 = ctx.createGain();
      osc1.frequency.value = 880;
      gain1.gain.setValueAtTime(0.2, now);
      gain1.gain.exponentialRampToValueAtTime(0.001, now + 0.15);
      osc1.connect(gain1).connect(ctx.destination);
      osc1.start(now);
      osc1.stop(now + 0.15);

      // ç¬¬äºŒè²
      const osc2 = ctx.createOscillator();
      const gain2 = ctx.createGain();
      osc2.frequency.value = 660;
      gain2.gain.setValueAtTime(0.2, now + 0.15);
      gain2.gain.exponentialRampToValueAtTime(0.001, now + 0.3);
      osc2.connect(gain2).connect(ctx.destination);
      osc2.start(now + 0.15);
      osc2.stop(now + 0.3);
    }

    // âœ… è‹±æ–‡ç™¼éŸ³ï¼šç¿»å‡ºè‹±æ–‡æ™‚å”¸å–®å­—
    function speakWord(text) {
      if (!("speechSynthesis" in window)) return;
      // æ¯æ¬¡å…ˆå–æ¶ˆå‰ä¸€å€‹ï¼Œé¿å…é‡ç–Š
      window.speechSynthesis.cancel();
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = "en-US";
      utter.rate = 1;     // é€Ÿåº¦
      utter.pitch = 1;    // éŸ³é«˜
      window.speechSynthesis.speak(utter);
    }

    function createCardElement(cardData) {
      const card = document.createElement("div");
      card.classList.add("card", cardData.type);
      card.dataset.type = cardData.type;
      card.dataset.id = cardData.id;

      if (cardData.type === "chinese") {
        // ä¸­æ–‡å¡ï¼šä¸€é–‹å§‹å°±é¡¯ç¤ºä¸­æ–‡
        card.textContent = wordMap[cardData.id].chinese;
      } else {
        // è‹±æ–‡å¡ï¼šä¸€é–‹å§‹è“‹èµ·ä¾†ï¼Œé¡¯ç¤ºå•è™Ÿ
        card.textContent = "ï¼Ÿ";
        card.classList.add("hidden-text");
      }

      card.addEventListener("click", () => onCardClick(card));
      return card;
    }

    function onCardClick(card) {
      if (lockBoard) return;

      const type = card.dataset.type;
      const id = card.dataset.id;
      const word = wordMap[id];

      // å·²ç¶“é…å°æˆåŠŸçš„å¡ä¸èƒ½å†é»
      if (card.classList.contains("matched")) return;

      if (type === "chinese") {
        // é»åˆ°ä¸­æ–‡å¡ï¼šé¸å– / å–æ¶ˆé¸å–
        if (selectedChinese && selectedChinese.element === card) {
          card.classList.remove("selected");
          selectedChinese = null;
          showMessage("");
          return;
        }

        if (selectedChinese && selectedChinese.element) {
          selectedChinese.element.classList.remove("selected");
        }

        selectedChinese = { element: card, id };
        card.classList.add("selected");
        showMessage("è«‹å†é¸ä¸€å¼µä½ è¦ºå¾—æ˜¯å°æ‡‰çš„è‹±æ–‡å¡ã€‚");

      } else if (type === "english") {
        // é»åˆ°è‹±æ–‡å¡
        if (!selectedChinese) {
          showMessage("è«‹å…ˆé¸ä¸€å¼µä¸­æ–‡å¡ï¼Œå†ä¾†ç¿»è‹±æ–‡å¡ã€‚");
          return;
        }

        // æš«æ™‚ç¿»é–‹è‹±æ–‡å…§å®¹ï¼‹å”¸å–®å­—
        card.textContent = word.english;
        card.classList.remove("hidden-text");
        speakWord(word.english);

        lockBoard = true;

        if (id === selectedChinese.id) {
          // âœ… é…å°æˆåŠŸ
          setTimeout(() => {
            card.classList.add("matched");
            selectedChinese.element.classList.add("matched");
            selectedChinese.element.classList.remove("selected");
            selectedChinese = null;
            lockBoard = false;
            showMessage("ç­”å°äº†ï¼å®å’šï½å¤ªæ£’äº† ğŸ¤©");
            playSuccessSound();
          }, 300);
        } else {
          // âŒ é…å°éŒ¯èª¤
          setTimeout(() => {
            // æŠŠè‹±æ–‡å¡å†è“‹å›å»
            card.textContent = "ï¼Ÿ";
            card.classList.add("hidden-text");

            if (selectedChinese && selectedChinese.element) {
              selectedChinese.element.classList.remove("selected");
            }
            selectedChinese = null;
            lockBoard = false;
            showMessage("å†è©¦è©¦çœ‹ï½å¯ä»¥æ›ä¸€å¼µä¸­æ–‡æˆ–è‹±æ–‡å¡ä¾†é…å°ã€‚");
          }, 800);
        }
      }
    }

    // æŠŠ 20 å¼µå¡ç‰‡ä¾ positions åŠ å…¥ç•«é¢
    positions.forEach((cardData) => {
      const el = createCardElement(cardData);
      grid.appendChild(el);
    });

    showMessage("è«‹å…ˆé»ä¸€å¼µã€Œä¸­æ–‡å¡ã€ï¼Œå†é»ä¸€å¼µè‹±æ–‡å¡ä¾†é…å°ã€‚");
  </script>
</body>
</html>
